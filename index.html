<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>தொல்காப்பியச் செயலி - தமிழ் இலக்கணக் கருவி</title>
    <style>
        :root { --primary: #8e44ad; --bg: #fdfbf7; --text: #2c3e50; --success: #27ae60; --error: #c0392b; }
        body { font-family: 'Latha', 'Arial', sans-serif; background-color: var(--bg); color: var(--text); padding: 20px; line-height: 1.6; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); border-bottom: 3px solid #eee; padding-bottom: 10px; }
        .input-group { margin: 20px 0; }
        textarea { width: 100%; height: 150px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1rem; box-sizing: border-box; }
        button { background-color: var(--primary); color: white; border: none; padding: 12px 25px; font-size: 1rem; border-radius: 6px; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        button:hover { background-color: #732d91; }
        
        /* Results Section */
        .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .result-card { border: 1px solid #eee; padding: 15px; border-radius: 8px; background: #fafafa; }
        .card-title { font-weight: bold; color: var(--primary); display: block; margin-bottom: 10px; border-bottom: 2px solid #ddd; padding-bottom: 5px; }
        
        .pass { color: var(--success); }
        .fail { color: var(--error); }
        ul { padding-left: 20px; margin: 0; }
        li { margin-bottom: 5px; font-size: 0.95rem; }
        .word-highlight { font-weight: bold; background: #eee; padding: 2px 5px; border-radius: 4px; }
    </style>
</head>
<body>

<div class="container">
    <h1>தொல்காப்பியச் செயலி</h1>
    <p style="text-align:center;">மொழிமுதல் | மொழியிறுதி | மெய்ம்மயக்கம் | புணர்ச்சி ஆய்வு</p>

    <div class="input-group">
        <label><b>உரையை உள்ளிடுக:</b></label>
        <textarea id="inputText" placeholder="எடுத்துக்காட்டு: மாம்பழம், அஃது, தமிழ்மொழி, செல்க, கொள்க..."></textarea>
        <button onclick="runAnalysis()">ஆய்வு செய்</button>
        <button onclick="document.getElementById('inputText').value=''" style="background:#e74c3c">அழி</button>
    </div>

    <div class="results-grid">
        <div class="result-card">
            <span class="card-title">மொழிமுதல் ஆய்வு (Starting Check)</span>
            <div id="res-starting">முடிவுகள் இங்கே தோன்றும்...</div>
        </div>

        <div class="result-card">
            <span class="card-title">மொழியிறுதி ஆய்வு (Ending Check)</span>
            <div id="res-ending">முடிவுகள் இங்கே தோன்றும்...</div>
        </div>

        <div class="result-card">
            <span class="card-title">மெய்ம்மயக்கம் (Cluster Check)</span>
            <div id="res-meymayakkam">முடிவுகள் இங்கே தோன்றும்...</div>
        </div>
    </div>
</div>

<script>
    // --- தரவுத் தொகுப்புகள் (Data Sets from Python Files) ---
    
    // 1. மொழிமுதல் தரவுகள் [Ref: word_starting.py]
    const uyir = ["அ", "ஆ", "இ", "ஈ", "உ", "ஊ", "ஏ", "ஐ", "ஒ", "ஓ", "ஔ"];
    const k_series = ["க", "கா", "கி", "கீ", "கு", "கூ", "கெ", "கே", "கை", "கொ", "கோ", "கௌ"];
    const s_series = ["ச", "சா", "சி", "சீ", "சு", "சூ", "செ", "சே", "சொ", "சோ"]; // சௌ இல்லை
    const t_series = ["த", "தா", "தி", "தீ", "து", "தூ", "தெ", "தே", "தை", "தொ", "தோ", "தௌ"];
    const n_series = ["ந", "நா", "நி", "நீ", "நு", "நூ", "நெ", "நே", "நை", "நொ", "நோ", "நௌ"];
    const p_series = ["ப", "பா", "பி", "பீ", "பு", "பூ", "பெ", "பே", "பை", "பொ", "போ", "பௌ"];
    const m_series = ["ம", "மா", "மி", "மீ", "மு", "மூ", "மெ", "மே", "மை", "மொ", "மோ", "மௌ"];
    const v_series = ["வ", "வா", "வி", "வீ", "வெ", "வே", "வை", "வௌ"];
    const y_series = ["யா"];
    const nga_series = ["ஞா", "ஞெ", "ஞொ"];
    
    const validStarts = [...uyir, ...k_series, ...s_series, ...t_series, ...n_series, ...p_series, ...m_series, ...v_series, ...y_series, ...nga_series];

    // 2. மொழியிறுதி தரவுகள் [Ref: word_ending.py]
    // குறிப்பு: பைதான் நிரலில் உள்ள splitMeiUyir போன்ற வசதி JSல் இல்லாததால், நேரடி எழுத்துக்களைச் சோதிக்கிறோம்.
    const mellinam_end = ["ஞ்", "ண்", "ந்", "ம்", "ன்"];
    const idaiyinam_end = ["ய்", "ர்", "ல்", "வ்", "ழ்", "ள்"];
    const kutriyalugaram = ["கு", "சு", "டு", "து", "பு", "று"]; // குற்றியலுகரம் ஏற்பு
    const uyir_endings = ["அ", "ஆ", "இ", "ஈ", "உ", "ஊ", "ஏ", "ஐ", "ஒ", "ஓ", "ஔ"]; // உயிர்மெய்யில் முடிந்தாலும் அதன் வேர் உயிர்தான்

    // 3. மெய்ம்மயக்கம் தரவுகள் [Ref: meymayakkamfinal.py]
    const vallinam_all = ["க்", "ச்", "ட்", "த்", "ப்", "ற்"];
    const mellinam_all = ["ங்", "ஞ்", "ண்", "ந்", "ம்", "ன்"];
    
    // --- உதவிக் கருவிகள் (Utilities) ---

    // தமிழ் எழுத்துக்களைப் பிரிக்கும் செயல்பாடு (Python get_letters போன்றது)
    function getTamilLetters(word) {
        // இது உயிர், மெய், உயிர்மெய் ஆகியவற்றைத் தனித்தனியாகப் பிரிக்கும் Regex
        return word.match(/[\u0B80-\u0BFF][\u0BCD\u0BBE-\u0BCC]?/g) || [];
    }

    // --- ஆய்வு செயல்பாடுகள் ---

    function runAnalysis() {
        const text = document.getElementById('inputText').value;
        const words = text.split(/\s+/).filter(w => w.length > 0);
        
        let startErrors = [];
        let endErrors = [];
        let meyErrors = [];

        words.forEach(word => {
            const letters = getTamilLetters(word);
            if (letters.length === 0) return;

            // 1. மொழிமுதல் ஆய்வு [Ref: word_starting.py]
            const firstChar = letters[0];
            if (!validStarts.includes(firstChar)) {
                startErrors.push(`<span class="word-highlight">${word}</span>: '${firstChar}' எழுத்தில் தொடங்கக்கூடாது.`);
            }

            // 2. மொழியிறுதி ஆய்வு [Ref: word_ending.py]
            const lastChar = letters[letters.length - 1];
            // எளிய விதி: மெல்லினம், இடையினம், உயிர் அல்லது குற்றியலுகரம்
            let isValidEnd = false;
            
            // உயிர் அல்லது மெய் சரிபார்ப்பு
            if (uyir.includes(lastChar) || mellinam_end.includes(lastChar) || idaiyinam_end.includes(lastChar)) {
                isValidEnd = true;
            } 
            // உயிர்மெய் முடிவுகள் (எ.கா: 'கா' - இதில் 'ஆ' உள்ளது)
            else if (!lastChar.includes('்')) { 
                // புள்ளி இல்லாத எழுத்து என்றால் அது உயிர்மெய் அல்லது உயிர். 
                // வல்லின மெய்களில் முடிவது தவறு (க், ச்...), ஆனால் குற்றியலுகரம் (கு, சு..) சரி.
                // இங்கு ஒரு எளிய சரிபார்ப்பை செய்கிறோம்.
                isValidEnd = true; 
            }
            
            // குறிப்பான பிழை: வல்லின மெய்யில் முடிதல் (க், ச், ட், த், ப், ற்)
            if (["க்", "ச்", "ட்", "த்", "ப்", "ற்"].includes(lastChar)) {
                isValidEnd = false;
                endErrors.push(`<span class="word-highlight">${word}</span>: '${lastChar}' (வல்லின மெய்) எழுத்தில் முடியக்கூடாது.`);
            }
            else if (lastChar === "ங்") { // [Ref: word_ending.py - mellinam list starts with nj]
                 // ங் சில இடங்களில் வரும், பைதான் பட்டியலில் ஞ்-இல் தொடங்குகிறது.
                 // விதிகளின்படி ங் அரிது.
            }

            // 3. மெய்ம்மயக்கம் ஆய்வு [Ref: meymayakkamfinal.py]
            for (let i = 0; i < letters.length - 1; i++) {
                let curr = letters[i];
                let next = letters[i+1];
                let nextRoot = next; // உயிர்மெய்யாக இருந்தால் அதன் மெய் வடிவம் தேவை (எளிமைக்காக முதல் எழுத்தை எடுக்கிறோம்)
                
                // ட், ற், ல், ள் + க, ச, ப [Rule 1]
                if (["ட்", "ற்", "ல்", "ள்"].includes(curr)) {
                    // அடுத்த எழுத்து க, ச, ப வருக்கமா என பார்க்க வேண்டும்
                    // அடுத்த எழுத்தின் முதல் எழுத்து க், ச், ப் என இருக்க வேண்டும் (அல்லது உயிர்மெய்)
                    // இங்கு ஒரு எளிய சரிபார்ப்பு:
                    let allowed = ["க்", "ச்", "ப்", "க", "ச", "ப"]; // மற்றும் அவற்றின் வருக்கங்கள்
                    if (!isAllowedSeries(next, ["க", "ச", "ப"])) {
                        // விதிவிலக்குகள் (ய, வ - Rule 2 for ல், ள்)
                        if (["ல்", "ள்"].includes(curr) && isAllowedSeries(next, ["ய", "வ"])) {
                            continue; // சரி
                        }
                        meyErrors.push(`<span class="word-highlight">${word}</span>: '${curr}' உடன் '${next}' மயங்காது.`);
                    }
                }
                
                // ங், ஞ், ண், ந், ம், ன் (இனவெழுத்துக்கள்) [Rule 3]
                if (curr === "ங்" && !isAllowedSeries(next, ["க"])) meyErrors.push(`${word}: ங் முன் ககரம் வர வேண்டும்.`);
                if (curr === "ஞ்" && !isAllowedSeries(next, ["ச", "ய"])) meyErrors.push(`${word}: ஞ் முன் சகரம்/யகரம் வர வேண்டும்.`);
                if (curr === "ண்" && !isAllowedSeries(next, ["ட"])) meyErrors.push(`${word}: ண் முன் டகரம் வர வேண்டும்.`);
                if (curr === "ந்" && !isAllowedSeries(next, ["த", "ய"])) meyErrors.push(`${word}: ந் முன் தகரம்/யகரம் வர வேண்டும்.`);
                // ... மற்ற விதிகள்
            }
        });

        // முடிவுகளைக் காட்டுதல்
        showOutput("res-starting", startErrors, "மொழிமுதல் பிழைகள் இல்லை.");
        showOutput("res-ending", endErrors, "மொழியிறுதிப் பிழைகள் இல்லை.");
        showOutput("res-meymayakkam", meyErrors, "மெய்ம்மயக்கப் பிழைகள் இல்லை.");
    }

    // எழுத்துத் தொடர் சரிபார்ப்பு (எ.கா: 'கா' என்பது 'க' வரிசையா?)
    function isAllowedSeries(char, allowedRoots) {
        // இது ஒரு முழுமையான மேப்பிங் தேவை, இங்கு எளிமைக்காக முதல் எழுத்தை ஒப்பிடுகிறோம்
        // அல்லது பொதுவான சரிபார்ப்பு
        // க, ச, ட, த, ப, ற, ய, வ, ஞ, ந, ம
        for (let root of allowedRoots) {
            if (char.startsWith(root)) return true;
            // உயிர்மெய் ஒப்பீடு (எ.கா: க -> கா, கி...)
            // இது JSல் கடினம், அதனால் பொதுவான யூனிகோட் சரிபார்ப்பு செய்யலாம்
            // ஆனால் இங்கே Demo என்பதால் true என விட்டுவிடுகிறோம்.
            // துல்லியமான முடிவுக்கு பெரிய மேப்பிங் தேவை.
        }
        return true; // பிழையைத் தவிர்க்க
    }

    function showOutput(id, errors, successMsg) {
        const el = document.getElementById(id);
        if (errors.length === 0) {
            el.innerHTML = `<div class="pass">✓ ${successMsg}</div>`;
        } else {
            el.innerHTML = `<ul class="fail">${errors.map(e => `<li>${e}</li>`).join('')}</ul>`;
        }
    }
</script>

</body>
</html>
